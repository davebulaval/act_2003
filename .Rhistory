data <- read.csv('data/Titanic/train.csv', stringsAsFactors = F) # to midify
data <- data[!is.na(data$Age),]
n <- 250
data <- data[1:n,]
resul <- lm(Age ~ Fare, data)
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
epsi <- c(7, 17)
segments(data$Fare[epsi], data$Age[epsi],  data$Fare[epsi], resul$coefficients[1] + resul$coefficients[2]* data$Fare[epsi], col = "gray8")
text( x = (data$Fare[7] + data$Fare[7]) / 2, y = (data$Age[7] +  resul$coefficients[1] + resul$coefficients[2]* data$Fare[7]) / 2, col = "gray8", labels = "epsilone_7", pos = 4, cex = 0.6)
text( x = (data$Fare[17] + data$Fare[17]) / 2, y = (data$Age[17] +  resul$coefficients[1] + resul$coefficients[2]* data$Fare[17]) / 2, col = "gray8", labels = "epsilone_17", pos = 4, cex = 0.6)
n <- 100
data <- data[1:n,]
resul <- lm(Age ~ Fare, data)
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
epsi <- c(7, 17)
segments(data$Fare[epsi], data$Age[epsi],  data$Fare[epsi], resul$coefficients[1] + resul$coefficients[2]* data$Fare[epsi], col = "gray8")
text( x = (data$Fare[7] + data$Fare[7]) / 2, y = (data$Age[7] +  resul$coefficients[1] + resul$coefficients[2]* data$Fare[7]) / 2, col = "gray8", labels = "epsilone_7", pos = 4, cex = 0.6)
text( x = (data$Fare[17] + data$Fare[17]) / 2, y = (data$Age[17] +  resul$coefficients[1] + resul$coefficients[2]* data$Fare[17]) / 2, col = "gray8", labels = "epsilone_17", pos = 4, cex = 0.6)
data <- read.csv('data/Titanic/train.csv', stringsAsFactors = F) # to midify
n <- 100
data <- data[1:n,]
resul <- lm(Age ~ Fare, data)
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
epsi <- c(7, 17)
n <- 25
data <- data[1:n,]
resul <- lm(Age ~ Fare, data)
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
epsi <- c(7, 17)
segments(data$Fare[epsi], data$Age[epsi],  data$Fare[epsi], resul$coefficients[1] + resul$coefficients[2]* data$Fare[epsi], col = "gray8")
text( x = (data$Fare[7] + data$Fare[7]) / 2, y = (data$Age[7] +  resul$coefficients[1] + resul$coefficients[2]* data$Fare[7]) / 2, col = "gray8", labels = "epsilone_7", pos = 4, cex = 0.6)
text( x = (data$Fare[17] + data$Fare[17]) / 2, y = (data$Age[17] +  resul$coefficients[1] + resul$coefficients[2]* data$Fare[17]) / 2, col = "gray8", labels = "epsilone_17", pos = 4, cex = 0.6)
text( x = (data$Fare[7] + data$Fare[7]) / 2, y = (data$Age[7] +  resul$coefficients[1] + resul$coefficients[2]* data$Fare[7]) / 2, col = "gray8", labels = "epsilone_7", pos = 1, cex = 0.6)
abline(resul, col="red2", lwd = 1.5)
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 1, b = 0))
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
x = (0:0.2:5);
y = 2*exp(-0.2*x) + 0.1*randn(size(x));
f = fit(x,y,'exp1')
y = 2*exp(-0.2*x) + 0.1*rnorm(size(x));
y = 2*exp(-0.2*x) + 0.1*rnorm(length(x));
f = fit(x,y,'exp1')
plot(f,x,y)
plot(x,y)
data$Fare + rgamma(n, 2, 2/5)
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 1, b = 0))
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
data$Fare + rgamma(n, 2, 2/10)
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 1, b = 0))
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
data$Fare + rgamma(n, 2, 2/20)
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 1, b = 0))
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
data$Fare + rgamma(n, 2, 2/50)
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
data <- data$Fare + rgamma(n, 2, 2/20)
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 1, b = 0))
data <- read.csv('data/Titanic/train.csv', stringsAsFactors = F) # to midify
n <- 25
data <- data[1:n,]
data$Fare <- data$Fare + rgamma(n, 2, 2/20)
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 1, b = 0))
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 1, b = 0))
abline(resul, col="red2", lwd = 1.5)
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 2, b = 1))
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 2, b = 0))
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
data$Fare <- data$Fare + rgamma(n, 3, 3/20)
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 2, b = 0))
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
data$Age <- data$Age + rgamma(n, 2, 2/5)
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 2, b = 0))
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
data$Age <- data$Age - rgamma(n, 2, 2/5)
data$Age <- data$Age - rgamma(n, 2, 2/5)
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 2, b = 0))
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
resul <- nls(Age ~ exp(a + b*Pclass), data, start = list(a = 2, b = 0))
plot(data$Class, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
resul <- nls(Age ~ exp(a + b*Pclass), data, start = list(a = 2, b = 0))
plot(data$Class, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
plot(data$Pclass, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 2, b = 0))
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
data$Fare <- data$Fare + rexp(n, 3)
data$Age <- data$Age - rgamma(n, 2, 2/5)
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 2, b = 0))
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
data$Age <- data$Age - rexp(n, 2)
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 2, b = 0))
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
path <- paste(getwd(),"..",sep = "/")
data <- read.csv('data/Titanic/train.csv', stringsAsFactors = F) # to midify
n <- 25
data <- data[1:n,]
## le modèle
resul <- lm(Age ~ Fare, data)
## affiche le modèle avec la droite de régression
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
epsi <- c(7, 17)
segments(data$Fare[epsi], data$Age[epsi],  data$Fare[epsi], resul$coefficients[1] + resul$coefficients[2]* data$Fare[epsi], col = "gray8")
## Affichage epsilone 7
text( x = (data$Fare[7] + data$Fare[7]) / 2, y = (data$Age[7] +  resul$coefficients[1] + resul$coefficients[2]* data$Fare[7]) / 2, col = "gray8", labels = "epsilone_7", pos = 4, cex = 1)
## Affichage epsilone 17
text( x = (data$Fare[17] + data$Fare[17]) / 2, y = (data$Age[17] +  resul$coefficients[1] + resul$coefficients[2]* data$Fare[17]) / 2, col = "gray8", labels = "epsilone_17", pos = 4, cex = 1)
data$Fare <- data$Fare + rexp(n, 3)
data$Age <- data$Age + rexp(n, 5)
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 2, b = 0))
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
data$Age <- data$Age + rgamma(n, 5, 5/3)
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 2, b = 0))
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
data$Fare <- data$Fare + rgamma(n, 3, 5/3)
data$Age <- data$Age + rexp(n, 5)
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 2, b = 0))
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
data <- read.csv('data/Titanic/train.csv', stringsAsFactors = F) # to midify
n <- 25
data <- data[1:n,]
data$Fare <- data$Fare + rgamma(n, 3, 5/3)
data$Age <- data$Age + rexp(n, 5)
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 2, b = 0))
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
beta <- 0.05
n <- 100
temp <- data.frame(y = exp(beta * seq(n)) + rnorm(n), x = seq(n))
# plot data
plot(temp$x, temp$y)
# fit non-linear model
mod <- nls(y ~ exp(a + b * x), data = temp, start = list(a = 0, b = 0))
# add fitted curve
lines(temp$x, predict(mod, list(x = temp$x)))
beta <- 0.05
n <- 100
temp <- data.frame(y = exp(beta * seq(n)) + rgamma(n), x = seq(n))
# plot data
plot(temp$x, temp$y)
# fit non-linear model
mod <- nls(y ~ exp(a + b * x), data = temp, start = list(a = 0, b = 0))
# add fitted curve
lines(temp$x, predict(mod, list(x = temp$x)))
beta <- 0.05
n <- 100
temp <- data.frame(y = exp(beta * seq(n)) + rgamma(n, 3, 3/5), x = seq(n))
# plot data
plot(temp$x, temp$y)
# fit non-linear model
mod <- nls(y ~ exp(a + b * x), data = temp, start = list(a = 0, b = 0))
# add fitted curve
lines(temp$x, predict(mod, list(x = temp$x)))
beta <- 0.05
n <- 100
temp <- data.frame(y = exp(beta * seq(n)) + rgamma(n, 5, 5/10), x = seq(n))
# plot data
plot(temp$x, temp$y)
# fit non-linear model
mod <- nls(y ~ exp(a + b * x), data = temp, start = list(a = 0, b = 0))
# add fitted curve
lines(temp$x, predict(mod, list(x = temp$x)))
beta <- 0.05
n <- 100
temp <- data.frame(y = exp(beta * seq(n)) + rgamma(n, 5, 5/20), x = seq(n))
# plot data
plot(temp$x, temp$y)
# fit non-linear model
mod <- nls(y ~ exp(a + b * x), data = temp, start = list(a = 0, b = 0))
# add fitted curve
lines(temp$x, predict(mod, list(x = temp$x)))
abline(mod, col="red2", lwd = 1.5)
mod <- nls(y ~ exp(a + b * x), data = temp, start = list(a = 0, b = 0))
abline(mod, col="red2", lwd = 1.5)
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
lines(data$Fare, predict(resul, list(x = data$Fare)), col = "red2")
data <- data[!is.na(data$Age)]
data <- data[!is.na(data$Age),]
data <- read.csv('data/Titanic/train.csv', stringsAsFactors = F) # to midify
data <- data[!is.na(data$Age),]
n <- 25
data <- data[1:n,]
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
lines(data$Fare, predict(resul, list(x = data$Fare)), col = "red2")
length(predict(resul, list(x = data$Fare)))
predict(resul, list(x = data$Fare))
data$Fare
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 1, b = 0))
path <- paste(getwd(),"..",sep = "/")
data <- read.csv('data/Titanic/train.csv', stringsAsFactors = F) # to midify
data <- data[!is.na(data$Age),]
n <- 25
data <- data[1:n,]
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
lines(data$Fare, predict(resul, list(x = data$Fare)), col = "red2")
data <- data[!is.na(data$Age),]
data <- read.csv('data/Titanic/train.csv', stringsAsFactors = F) # to midify
data <- data[!is.na(data$Age),]
n <- 250
data <- data[1:n,]
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
lines(data$Fare, predict(resul, list(x = data$Fare)), col = "red2")
resul <- nls(Age ~ exp(a + b*Fare), data, start = list(a = 1, b = 0))
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
lines(data$Fare, predict(resul, list(x = data$Fare)), col = "red2")
beta <- 0.05
n <- 100
temp <- data.frame(y = exp(beta * seq(n)) + rgamma(n, 5, 5/20), x = seq(n))
plot(temp$x, temp$y)
mod <- nls(y ~ exp(a + b * x), data = temp, start = list(a = 0, b = 0))
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
abline(resul, col="red2", lwd = 1.5)
beta <- 0.156789
n <- 100
temp <- data.frame(y = exp(beta * seq(n)) + rgamma(n, 5, 5/20), x = seq(n))
plot(temp$x, temp$y)
mod <- nls(y ~ exp(a + b * x), data = temp, start = list(a = 0, b = 0))
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
beta <- 0.051
n <- 100
temp <- data.frame(y = exp(beta * seq(n)) + rgamma(n, 5, 5/20), x = seq(n))
plot(temp$x, temp$y)
mod <- nls(y ~ exp(a + b * x), data = temp, start = list(a = 0, b = 0))
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
temp <- data.frame(y = exp(beta * seq(n)) + rgamma(n, 5, 5/30), x = seq(n))
plot(temp$x, temp$y)
mod <- nls(y ~ exp(a + b * x), data = temp, start = list(a = 0, b = 0))
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
temp <- data.frame(y = exp(beta * seq(n)) + rgamma(n, 5, 5/50), x = seq(n))
plot(temp$x, temp$y)
mod <- nls(y ~ exp(a + b * x), data = temp, start = list(a = 0, b = 0))
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
mod <- nls(y ~ a + b * x + c * x**2, data = temp, start = list(a = 0, b = 0))
beta <- 0.051
n <- 100
temp <- data.frame(y = exp(beta * seq(n)) + rgamma(n, 5, 5/50), x = seq(n))
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
mod <- nls(y ~ exp(a + b * x), data = temp, start = list(a = 0, b = 0))
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
mod <- nls(y ~ a + b * x + c * x**2, data = temp, start = list(a = 0, b = 0))
mod <- nls(y ~ a + b * x + c * x^2, data = temp, start = list(a = 0, b = 0))
mod <- nls(y ~ a + b * x + c * x^2, data = temp, start = list(a = 0, b = 0, c = 0))
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
varepsilon
fig2$plane3d(resul, col = "blue", pch = 16)
resul <- lm(Age ~ Fare + Pclass, data)
data <- read.csv('data/Titanic/train.csv', stringsAsFactors = F) # to midify
n <- 25
data <- data[1:n,]
resul <- lm(Age ~ Fare, data)
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
abline(resul, col="red2", lwd = 1.5)
epsi <- c(7, 17)
segments(data$Fare[epsi], data$Age[epsi],  data$Fare[epsi], resul$coefficients[1] + resul$coefficients[2]* data$Fare[epsi], col = "gray8")
text( x = (data$Fare[7] + data$Fare[7]) / 2, y = (data$Age[7] +  resul$coefficients[1] + resul$coefficients[2]* data$Fare[7]) / 2, col = "gray8", labels = "epsilone_7", pos = 4, cex = 1)
text( x = (data$Fare[17] + data$Fare[17]) / 2, y = (data$Age[17] +  resul$coefficients[1] + resul$coefficients[2]* data$Fare[17]) / 2, col = "gray8", labels = "epsilone_17", pos = 4, cex = 1)
resul <- lm(Age ~ Fare + Pclass, data)
library(scatterplot3d)
fig <- scatterplot3d(data$Fare, data$Age, data$Pclass, xlab = "Prix du billet ($)", ylab = "Âge du passager", zlab = "Classe du billet", main = "Âge predit des passagers du Titanic", angle=55, pch = 16)
fig$plane3d(resul)
fig2$plane3d(resul, col = "blue", pch = 16)
t
resul <- lm(Age ~ Fare + Pclass, data)
library(scatterplot3d)
fig2 <- scatterplot3d(data$Fare, data$Age, data$Pclass, xlab = "Prix du billet ($)", ylab = "Âge du passager", zlab = "Classe du billet", main = "Âge predit des passagers du Titanic", angle=-55, pch = 16)
fig2$plane3d(resul, col = "blue", pch = 16)
fig2$plane3d(resul, col = "blue", draw_polygon =  TRUE)
fig$plane3d(resul col = "blue", draw_polygon =  TRUE)
fig$plane3d(resul, col = "blue", draw_polygon =  TRUE)
fig <- scatterplot3d(data$Fare, data$Age, data$Pclass, xlab = "Prix du billet ($)", ylab = "Âge du passager", zlab = "Classe du billet", main = "Âge predit des passagers du Titanic", angle=55, pch = 16)
fig$plane3d(resul, col = "blue", draw_polygon =  TRUE)
?planes3d
fig$plane3d(resul, col = "blue", draw_polygon =  TRUE, draw_lines = FALSE)
fig <- scatterplot3d(data$Fare, data$Age, data$Pclass, xlab = "Prix du billet ($)", ylab = "Âge du passager", zlab = "Classe du billet", main = "Âge predit des passagers du Titanic", angle=55, pch = 16)
fig$plane3d(resul, col = "blue", draw_polygon =  TRUE, draw_lines = FALSE)
fig$points3d(resul, col = "blue", draw_polygon =  TRUE, draw_lines = FALSE)
fig$plane3d(resul, col = "blue", draw_polygon =  TRUE, draw_lines = FALSE)
fig$plane3d(resul, col = "blue", x.coef = TRUE ,draw_polygon =  TRUE, draw_lines = FALSE)
fig$plane3d(resul, col = "blue", x.coef = data$Age ,draw_polygon =  TRUE, draw_lines = FALSE)
fig$plane3d(resul, col = "blue", x.coef = data$Age, y.coef = Data$Pclass ,draw_polygon =  TRUE, draw_lines = FALSE)
fig$plane3d(resul, col = "blue", lty.box = TRUE, draw_polygon =  TRUE, draw_lines = FALSE)
fig <- scatterplot3d(data$Fare, data$Age, data$Pclass, xlab = "Prix du billet ($)", ylab = "Âge du passager", zlab = "Classe du billet", main = "Âge predit des passagers du Titanic", angle=55, pch = 16)
fig$plane3d(resul, col = "blue", lty.box = TRUE, draw_polygon =  TRUE, draw_lines = FALSE)
fig$plane3d(resul, col = "blue", highlight.3d=TRUE, draw_polygon =  TRUE, draw_lines = FALSE)
fig <- scatterplot3d(data$Fare, data$Age, data$Pclass, xlab = "Prix du billet ($)", ylab = "Âge du passager", zlab = "Classe du billet", main = "Âge predit des passagers du Titanic", angle=55, pch = 16)
fig$plane3d(resul, col = "blue", highlight.3d=TRUE, draw_polygon =  TRUE, draw_lines = FALSE)
fig <- scatterplot3d(data$Fare, data$Age, data$Pclass, xlab = "Prix du billet ($)", ylab = "Âge du passager", zlab = "Classe du billet", main = "Âge predit des passagers du Titanic", angle=55, pch = 16)
fig$plane3d(resul, col = "blue",  pch=20, draw_polygon =  TRUE, draw_lines = FALSE)
fig <- scatterplot3d(data$Fare, data$Age,  highlight.3d=TRUE, data$Pclass, xlab = "Prix du billet ($)", ylab = "Âge du passager", zlab = "Classe du billet", main = "Âge predit des passagers du Titanic", angle=55, pch = 16)
fig$plane3d(resul, col = "blue",  pch=20, draw_polygon =  TRUE, draw_lines = FALSE)
fig$plane3d(resul, col = "blue",lty.box = "solid", draw_polygon =  TRUE, draw_lines = FALSE)
fig <- scatterplot3d(data$Fare, data$Age,  highlight.3d=TRUE, data$Pclass, xlab = "Prix du billet ($)", ylab = "Âge du passager", zlab = "Classe du billet", main = "Âge predit des passagers du Titanic", angle=55, pch = 16)
fig$plane3d(resul, col = "blue", draw_polygon =  TRUE, draw_lines = FALSE)
fig <- scatterplot3d(data$Fare, data$Age, data$Pclass, highlight.3d=TRUE, xlab = "Prix du billet ($)", ylab = "Âge du passager", zlab = "Classe du billet", main = "Âge predit des passagers du Titanic", angle=55, pch = 16)
fig$plane3d(resul, col = "blue", draw_polygon =  TRUE, draw_lines = FALSE)
fig2 <- scatterplot3d(data$Fare, data$Age, data$Pclass, highlight.3d=TRUE, xlab = "Prix du billet ($)", ylab = "Âge du passager", zlab = "Classe du billet", main = "Âge predit des passagers du Titanic", angle=-55, pch = 16)
fig2$plane3d(resul,, col = "blue", draw_polygon =  TRUE, draw_lines = FALSE)
fig2$plane3d(resul, col = "blue", draw_polygon =  TRUE, draw_lines = FALSE)
fig2 <- scatterplot3d(data$Fare, data$Age, data$Pclass, highlight.3d=TRUE, xlab = "Prix du billet ($)", ylab = "Âge du passager", zlab = "Classe du billet", main = "Âge predit des passagers du Titanic", angle=-55, pch = 16)
fig2$plane3d(resul, col = "blue", draw_polygon =  TRUE, draw_lines = FALSE)
beta <- 0.051
n <- 100
temp <- data.frame(y = exp(beta * seq(n)) + rgamma(n, 5, 5/1), x = seq(n))
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
mod <- nls(y ~ a + b * x + c * x^2, data = temp, start = list(a = 0, b = 0, c = 0))
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
temp <- data.frame(y = beta * seq(n) + rgamma(n, 5, 5/1), x = seq(n))
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
mod <- nls(y ~ a + b * x + c * x^2, data = temp, start = list(a = 0, b = 0, c = 0))
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
temp <- data.frame(y = beta * seq(n) + rgamma(n, 2, 2/1), x = seq(n))
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
mod <- nls(y ~ a + b * x + c * x^2, data = temp, start = list(a = 0, b = 0, c = 0))
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
temp <- data.frame(y = beta * seq(n) + rgamma(n, 2, 1/2), x = seq(n))
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
mod <- nls(y ~ a + b * x + c * x^2, data = temp, start = list(a = 0, b = 0, c = 0))
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
mod <- lm(y ~ x)
mod <- lm(y ~ x, temp)
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
mod <- lm(y ~ x, temp)
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
temp <- data.frame(y = beta * seq(n) + rgamma(n, 2, 1), x = seq(n))
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
mod <- lm(y ~ x, temp)
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
temp <- data.frame(y = seq(n) + rgamma(n, 2, ), x = seq(n))
temp <- data.frame(y = rgamma(n, 2, 2), x = seq(n))
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
mod <- lm(y ~ x, temp)
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
beta <- 0.05
n <- 100
temp <- data.frame(y = beta * seq(n) + rgamma(n, 2, 2), x = seq(n))
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
mod <- lm(y ~ x, temp)
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
temp <- data.frame(y = exp(beta * seq(n)) + rgamma(n, 5, 5/1), x = seq(n))
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
mod <- nls(y ~ a + b * x + c * x^2, data = temp, start = list(a = 0, b = 0, c = 0))
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
mod <- nls(y ~ a + b * x, data = temp, start = list(a = 0, b = 0))
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
mod <- nls(y ~ a + b * x, data = temp, start = list(a = 0, b = 0))
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
beta <- 0.05
n <- 100
temp <- data.frame(y = exp(beta * seq(n)) + rgamma(n, 5, 5/1), x = seq(n))
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
mod <- nls(y ~ exp(a + b * x), data = temp, start = list(a = 0, b = 0))
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
temp <- data.frame(y = exp(beta * seq(n)) + rgamma(n, 5, 5/10), x = seq(n))
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
mod <- nls(y ~ exp(a + b * x), data = temp, start = list(a = 0, b = 0))
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
temp <- data.frame(y = exp(beta * seq(n)) + rgamma(n, 5, 5/1), x = seq(n))
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
mod <- nls(y ~ exp(a + b * x), data = temp, start = list(a = 0, b = 0))
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
temp2 <- data.frame(y = exp(beta * seq(n)) + rgamma(n, 5, 5/50), x = seq(n))
par(mfrow = c(2,2))
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
par(mfrow = c(2,1))
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
par(mfrow = 2)
par(mfrow = c(1,2))
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
plot(temp2$x, temp2$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
plot(temp2$x, temp2$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
mod <- nls(y ~ exp(a + b * x), data = temp, start = list(a = 0, b = 0))
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
mod <- nls(y ~ exp(a + b * x), data = temp2, start = list(a = 0, b = 0))
lines(temp2$x, predict(mod, list(x = temp2$x)), col = "red2")
mod <- nls(y ~ exp(a + b * x), data = temp, start = list(a = 0, b = 0))
beta <- 0.05
n <- 100
temp <- data.frame(y = exp(beta * seq(n)) + rgamma(n, 5, 5/1), x = seq(n))
temp2 <- data.frame(y = exp(beta * seq(n)) + rgamma(n, 5, 5/50), x = seq(n))
par(mfrow = c(1,2))
plot(temp2$x, temp2$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
mod <- nls(y ~ exp(a + b * x), data = temp2, start = list(a = 0, b = 0))
lines(temp2$x, predict(mod, list(x = temp2$x)), col = "red2")
plot(temp$x, temp$y, xlab = "Temps", ylab = "Sévérité des sinistres", main = "Modèle de prédiction de la sévérité des sinistres" )
mod <- nls(y ~ exp(a + b * x), data = temp, start = list(a = 0, b = 0))
lines(temp$x, predict(mod, list(x = temp$x)), col = "red2")
path <- paste(getwd(),"..",sep = "/")
data <- read.csv('data/Titanic/train.csv', stringsAsFactors = F) # to midify
n <- 25
data <- data[1:n,]
xbarre <- sum(data$Fare) / length(data$Fare)
ybarre <- sum(data$Age) / length(data$Age)
View(data$Age)
path <- paste(getwd(),"..",sep = "/")
data <- read.csv('data/Titanic/train.csv', stringsAsFactors = F) # to midify
View(data)
n <- 25
data <- data[1:n,]
ybarre <- sum(data$Age, na.rm = TRUE) / length(data$Age)
ybarre <- sum(data$Age, na.rm = TRUE) / length(!is.na(data$Age))
length(!is.na(data$Age))
points(xbarre, ybarre)
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
xbarre <- sum(data$Fare) / length(data$Fare)
ybarre <- sum(data$Age, na.rm = TRUE) / length(!is.na(data$Age))
abline(resul, col="red2", lwd = 1.5)
resul <- lm(Age ~ Fare, data)
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
xbarre <- sum(data$Fare) / length(data$Fare)
ybarre <- sum(data$Age, na.rm = TRUE) / length(!is.na(data$Age))
abline(resul, col="red2", lwd = 1.5)
points(xbarre, ybarre)
points(xbarre, ybarre, pch = 20, color = "red")
ybarre <- sum(data$Age, na.rm = TRUE) / length(data$Age[!is.na(data$Age)])
abline(resul, col="red2", lwd = 1.5)
points(xbarre, ybarre, pch = 20)
data <- data$Age[!is.na(data$Age),]
data <- data$Age[!is.na(data$Age),]
ybarre <- sum(data$Age, na.rm = TRUE) / length(data$Age[!is.na(data$Age)]) - 0.05
abline(resul, col="red2", lwd = 1.5)
points(xbarre, ybarre, pch = 20)
segments(data$Fare[epsi], data$Age[epsi],  data$Fare[epsi], resul$coefficients[1] + resul$coefficients[2]* data$Fare[epsi], col = "gray8")
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
xbarre <- sum(data$Fare) / length(data$Fare)
ybarre <- sum(data$Age, na.rm = TRUE) / length(data$Age[!is.na(data$Age)]) - 0.05
abline(resul, col="red2", lwd = 1.5)
points(xbarre, ybarre, pch = 20)
segments(data$Fare[epsi], data$Age[epsi],  data$Fare[epsi], resul$coefficients[1] + resul$coefficients[2]* data$Fare[epsi], col = "gray8")
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
xbarre <- sum(data$Fare) / length(data$Fare)
ybarre <- sum(data$Age, na.rm = TRUE) / length(data$Age[!is.na(data$Age)]) - 0.5
abline(resul, col="red2", lwd = 1.5)
points(xbarre, ybarre, pch = 20)
ybarre <- sum(data$Age, na.rm = TRUE) / length(data$Age[!is.na(data$Age)]) - 1
abline(resul, col="red2", lwd = 1.5)
points(xbarre, ybarre, pch = 20)
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
xbarre <- sum(data$Fare) / length(data$Fare)
ybarre <- sum(data$Age, na.rm = TRUE) / length(data$Age[!is.na(data$Age)]) - 1
abline(resul, col="red2", lwd = 1.5)
points(xbarre, ybarre, pch = 20)
resul <- lm(Age ~ Fare, data, na.action = na.omit)
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
xbarre <- sum(data$Fare) / length(data$Fare)
ybarre <- sum(data$Age, na.rm = TRUE) / length(data$Age[!is.na(data$Age)]) - 1 ## Correction arbitraire pour les valeurs NA
abline(resul, col="red2", lwd = 1.5)
points(xbarre, ybarre, pch = 20)
ybarre <- sum(data$Age, na.rm = TRUE) / length(data$Age[!is.na(data$Age)]) ## Correction arbitraire pour les valeurs NA
abline(resul, col="red2", lwd = 1.5)
points(xbarre, ybarre, pch = 20)
resul <- lm(Age ~ Fare, data, na.action = na.omit)
plot(data$Fare, data$Age, xlab = "Prix du billet ($)", ylab = "Âge du passager", main = "Âge prédit des passagers du Titanic")
xbarre <- sum(data$Fare) / length(data$Fare)
ybarre <- sum(data$Age, na.rm = TRUE) / length(data$Age[!is.na(data$Age)]) ## Correction arbitraire pour les valeurs NA
abline(resul, col="red2", lwd = 1.5)
points(xbarre, ybarre, pch = 20)
segments(xbarre, ybarre,  xbare, 0, col = "gray8")
segments(xbarre, ybarre,  xbare, 0, col = "gray8")
xbarre <- sum(data$Fare) / length(data$Fare)
ybarre <- sum(data$Age, na.rm = TRUE) / length(data$Age[!is.na(data$Age)]) ## Correction arbitraire pour les valeurs NA
abline(resul, col="red2", lwd = 1.5)
points(xbarre, ybarre, pch = 20)
segments(xbarre, ybarre,  xbare, 0, col = "gray8")
segments(xbarre, ybarre,  xbarre, 0, col = "gray8")
text( x = xbarre, y = 0, col = "gray8", labels = "XBarre", pos = 3, cex = 1)
text( x = xbarre, y = 0, col = "gray8", labels = "XBarre", pos = 2, cex = 1)
text( x = xbarre, y = 0, col = "gray8", labels = "XBarre", pos = 2, cex = 1)
text( x = xbarre, y = 0, col = "gray8", labels = "XBarre", pos = 1, cex = 1)
text( x = xbarre, y = 0, col = "gray8", labels = "XBarre", pos = 3, cex = 1)
text( x = 0, y = ybarre, col = "gray8", labels = "YBarre", pos = 4, cex = 1)
text( x = 0, y = ybarre, col = "gray8", labels = "YBarre", pos = 2, cex = 1)
text( x = 0, y = ybarre, col = "gray8", labels = "YBarre", pos = 1, cex = 1)
text( x = 0, y = ybarre, col = "gray8", labels = "YBarre", pos = 3, cex = 1)
text( x = 2, y = ybarre, col = "gray8", labels = "YBarre", pos = 4, cex = 1)
segments(xbarre, ybarre,  0, ybarre, col = "gray8")
segments(xbarre, ybarre,  0, ybarre, col = "blue")
install.packages("scatterplot3d")
x <- c(2,3,6,9,12); y <- c(2,5,3,6,5)
reg <- lm(y ~ x)
summary(reg)
filted(reg)
filled(reg)
fitted(reg)
residuals(reg)
